<!DOCTYPE html>
<html>
	<head>
		<title>HTML viewer</title>
		<style>
			#nonfullscreen {
				display: block;
			}
			body {
				background-color:cornsilk;
				padding:0px;
				white-space: nowrap;
			}
			.border {
				background-color: darkgray;
				text-align: center;
				user-select: none;
				font-size: 32px;
				display: inline-block;
				border: none;
				float: left;
			}
			.border:hover {
				background-color: gray;
				text-align: center;
				user-select: none;
				font-size: 32px;
				display: inline-block;
				border: none;
				float: left;
			}
			iframe {
				border: none;
				display: block;
				margin: 0px;
				padding: 0px;
				outline: none;
			}
			textarea {
				resize: vertical;
				border: none;
				white-space: pre;
				width: 90%;
			}
			.exitfull {
				position: fixed;
				opacity: 0.3;
				border: 1px solid black;
				background-color: darkgray;
				top: 0;
				left: 0;
				width: 92px;
				height: 20px;
				padding: 0px;
				border-bottom-right-radius: 10px;
			}
			.exitfull:hover {
				position: fixed;
				opacity: 0.8;
				border: 1px solid black;
				background-color: gray;
				top: 0;
				left: 0;
				width: 92px;
				height: 20px;
				padding: 0px;
				border-bottom-right-radius: 10px;
			}
		</style>
		<script>
			function save() {
				localStorage.setItem('HTMLSAVE', document.getElementById("input").value);
			};
			window.onload = function() {
				document.getElementById("input").value = localStorage.getItem('HTMLSAVE');
			};
			function download(filename, text) {
				var element = document.createElement('a');
				element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
				element.setAttribute('download', filename);
				
				element.style.display = 'none';
				document.body.appendChild(element);

				element.click();
				
				document.body.removeChild(element);
			};
			function downloadHTML() {
				download("index.html",document.getElementById("input").value);
			};
			window.onbeforeunload = function() {
				if (document.getElementById("input").value.length > 0) {
					return 'Are you sure you want to leave?';
				};
			};
			function updateAsHTML() {
				document.getElementById("embed").srcdoc=document.getElementById("input").value;
				save();
			};
			var fullscreen = false;
			function toggleFullScreen() {
				if (fullscreen == true) {
					fullscreen = false;
					document.getElementById("nonfullscreen").style.display="block";
					document.getElementsByClassName("exitfull")[0].style.display="none";
				} else {
					fullscreen = true;
					document.getElementById("nonfullscreen").style.display="none";
					document.getElementsByClassName("exitfull")[0].style.display="block";
				};
			};
			var darkModeOn = false;
			function darkMode() {
				if (darkModeOn == true) {
					darkModeOn = false;
					document.getElementById("input").style.backgroundColor="white";
					document.getElementById("input").style.color="black";
					document.getElementById("jsinput").style.backgroundColor="white";
					document.getElementById("jsinput").style.color="black";
					document.body.style="background-color: cornsilk; color: black";
				} else {
					darkModeOn = true;
					document.getElementById("input").style.backgroundColor="darkslategray";
					document.getElementById("input").style.color="white";
					document.getElementById("jsinput").style.backgroundColor="darkslategray";
					document.getElementById("jsinput").style.color="white";
					document.body.style="background-color: #000723; color: white";
				};
			};
			function unloadHTML() {
				document.getElementById("embed").srcdoc="";
			};
			function iFrameJavascript() {
			alert("bob");
			};
			function runJavascript() {
				var x = document.getElementById('embed').contentWindow.createElement("script");
				x.id="scriptbob";
				x.innerHTML = "function thisFunctionIsMegaLongSoItDoesntInterfereWithThePageAndItIsAFunctionBobTomFredMike() {"+document.getElementById("jsinput").value+"};";
				document.getElementById('embed').contentWindow.thisFunctionIsMegaLongSoItDoesntInterfereWithThePageAndItIsAFunctionBobTomFredMike();
				x.remove();
			};
		</script>
	</head>
	<body>
		<div id="nonfullscreen">
			<h1>HTML viewer</h1><br>
			<hr>
			<label>Settings:</label>
			<input id="darkmode" type="checkbox" onclick="darkMode();">Dark mode |</input>
			<button onclick="save();" title="autosaves when clicking update html">Save</button>
			<hr>
			<textarea style="background-color:white;color:black;height:350px;" placeholder="Type HTML" id="input" spellcheck="false" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}"></textarea><br>
			<textarea style="background-color:white;color:black;height:100px;display: none;" placeholder="Type javascript" id="jsinput" spellcheck="false" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}"></textarea>
			<button class="border" style="width:100%;" onclick="updateAsHTML();"><strong>Update HTML</strong></button><br>
			<button class="border" style="width:33.333%;" onclick="downloadHTML();"><strong>Download</strong></button>
			<button class="border" style="width:33.333%;" onclick="unloadHTML();"><strong>Unload HTML</strong></button>
			<button class="border" style="width:25%;display: none;" onclick="runJavascript();"><strong>Run javascript</strong></button>
			<button class="border" style="width:33.333%;" onclick="toggleFullScreen();"><strong>Fullscreen</strong></button><br>
		</div>
	</body>
	<div style="background-color:white">
			<button style="display: none;" class="exitfull" onclick="toggleFullScreen()">Exit fullscreen</button>
			<iframe id="embed" srcdoc="<p>type in text box and press update html</p>" width="100%" height="617"></iframe>
	</div>
</html>
