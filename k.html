<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>GIOo</title>
		<style>
			* {
				box-sizing: border-box;
			}
			html,body {
				width: 100%;
				height: 100%;
			}
			body {
				margin: 0;
			}
			#canvas {
				width: 100%;
				height: 100%;
				outline: none;
			}
			#canvas-wrapper {
				width: 100%;
				height: 100%;
				outline: none;
			}
		</style>
		<script src="./babylon.js"></script>
	</head>
	<body>
		<div id="canvas-wrapper" tabindex="0" onkeydown="keysDown[event.key] = true;" onkeyup="keysDown[event.key] = false;">
			<canvas id="canvas"></canvas>
		</div>
	</body>
	<script>
		var canvas = document.getElementById("canvas");
		var engine = new BABYLON.Engine(canvas);

		var playerDir = 0;

		var scene = new BABYLON.Scene(engine);
		scene.clearColor = new BABYLON.Color3(0.8, 0.8, 0.8);
		var camera = new BABYLON.FreeCamera("camera", new BABYLON.Vector3(0, 0, -10), scene);
		var light = new BABYLON.PointLight("light", new BABYLON.Vector3(0, 10, 0), scene);

		var keysDown = {};
		function isDown(key) {
			return keysDown[key] ?? false;
		};

		light.intensity = 1;

		var box = BABYLON.Mesh.CreateBox("box", 2, scene);
		box.rotation.x = 0;
		box.rotation.y = 0;
		var ground = BABYLON.MeshBuilder.CreateBox("box", {height: 0.1, width: 100, depth: 100});
		ground.rotation.x = 0;
		ground.rotation.y = 0;
		ground.position.x = 0;
		ground.position.y = -3;
		var box3 = BABYLON.MeshBuilder.CreateBox("box", {height: 1, width: 1, depth: 1});
		box3.rotation.x = 0;
		box3.rotation.y = 0;

		var boxMaterial = new BABYLON.StandardMaterial("material", scene);
		boxMaterial.emissiveColor = new BABYLON.Color3(0, 0.58, 0.86);
		box.material = boxMaterial;
		ground.material = boxMaterial;
		box3.material = boxMaterial;

		var renderLoop = function(){
			camera.position.x += (isDown("w") - isDown("s")) * 0.3 * Math.sin(camera.rotation.y);
			camera.position.z += (isDown("w") - isDown("s")) * 0.3 * Math.cos(camera.rotation.y);
			camera.position.x += (isDown("d") - isDown("a")) * 0.3 * Math.sin(camera.rotation.y + 1.5708);
			camera.position.z += (isDown("d") - isDown("a")) * 0.3 * Math.cos(camera.rotation.y + 1.5708);

			camera.rotation.x += (isDown("ArrowDown") - isDown("ArrowUp")) * 0.02;
			camera.rotation.y += (isDown("ArrowRight") - isDown("ArrowLeft")) * 0.05;
			//camera.translate(new BABYLON.Vector3(1, 0, 1), 1, BABYLON.Space.WORLD);

			scene.render();
		};
		engine.runRenderLoop(renderLoop);
	</script>
</html>
