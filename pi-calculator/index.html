<!DOCTYPE html>
<html>
	<head>
		<title>Pi calculator</title>
		<style>
			*,*::before,*::after {
				box-sizing: border-box;
			}
			html,body {
				width: 100%;
				height: 100%;
			}
			body {
				margin: 0px;
				background-color: cornsilk;
				overflow: hidden;
			}
			button {
				width: 50%;
				float: left;
			}
			#output {
				width: 100%;
				resize: none;
				height: calc(100vh - 100px - 3em);
			}
			label {
				font-family: monospace;
			}
			#steps {
				font-family: monospace;
				width: calc(100% - 7ch)
			}
		</style>
		<script>
			var pibud = 0;
			var numerator = 2;
			var denominator = 3;
			var addn = 1;
			var addd = 0;
			var i = 0;
			var interval;
			var atonce = 3;
			
			function calculate() {
				document.getElementById("calculateButton").disabled = true;				
				pi = 0;
				numerator = 2;
				denominator = 3;
				addn = 1;
				addd = 0;
				i = 0;
				document.getElementById("output").value = "";
				
				pi = 4*(numerator/denominator);
				interval = setInterval(function(){
					for (let ibudget = 0; ibudget < atonce; ibudget++) {
						addn++;
						addd++;
						if (addn >= 2) {
							addn = 0;
							numerator+=2;
						};
						if (addd >= 2) {
							addd = 0;
							denominator+=2;
						};
						pi = 4*((pi/4)*(numerator/denominator));
						document.getElementById("output").value = `${Math.floor(((i*atonce)/document.getElementById("steps").valueAsNumber)*10000)/100}%,\t${pi}\n`;
						document.getElementById("output").scrollTo(0, document.getElementById("output").scrollHeight);
					};
					i++;
					if (i >= document.getElementById("steps").valueAsNumber/atonce) {
						clearInterval(interval);
						document.getElementById("calculateButton").disabled = false;
					};
				}, 1);
			};
		</script>
	</head>
	<body>
		<h1>Pi calculator</h1>
		<hr>
		<label for="steps">Steps:</label>
		<input id="steps" type="number" value="100000">
		<button id="calculateButton" onclick="calculate();">Calculate</button>
		<button onclick="clearInterval(interval); document.getElementById('calculateButton').disabled = false;">Stop</button>
		<textarea id="output" readonly></textarea>
	</body>
</html>
